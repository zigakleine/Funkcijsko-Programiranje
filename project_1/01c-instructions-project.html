<!DOCTYPE html>
<!-- saved from url=(0077)https://lkrv.gitlab.io/funkcijsko-programiranje/01c-instructions-project.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>01c-instructions-project</title>
      
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="./01c-instructions-project_files/katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h1 class="mume-header" id="fri-secret-messages">FRI Secret Messages</h1>

<blockquote>
<p><em>Project 1, course in functional programming</em><br>
ver. 1.0c</p>
</blockquote>
<h2 class="mume-header" id="introduction-mdash-plagiarizing-homework">Introduction — Plagiarizing homework</h2>

<p>Some students are plagiarizing homework. On a tutorials a student was sharing an encrypted file <code>pt.c.enc</code> possibly containing solutions for the homework. An assistant was able to catch/intercept this encrypted message <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> (file <code>pt.c.enc</code>). Help the assistant break intercepted ciphertext.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token keyword keyword-val">val</span> y <span class="token operator">=</span> <span class="token string">"Y,}*a@F^d'=1$e:g!n&amp;x:L}U9(y8on+x+a:N2ym0 mQn+o#a)aaO4l+&lt;Y,}*a@F^P#q]/lJj.\"oE./].Ff!HS=af~|sakH#jRWVJ835\\UY5sQtW+\n,2s{]MNFbpN\nf\\qZ5&lt;YMfBKA9g\\$q.4lx*K(i{R=?LCo`+[:LBKv91W&gt;Wu[0CT}.{%c[Wk-1L&lt;\"R3M&lt;IU5\ngIoK|]b4)0?&lt;7^:zBA@&amp;TM0m$^iV1TmhC2]0 bohxX.LS?4MTZ#m.V4XQ0jLE|8Zxg\\*?eow2O\n*3p}T(_3^|Jo6WsL&lt;~`5Uh/G?\"ESG,KZ)s~)}XySr7L!q5i_{yX?-d#BfD rG8SyLoH2d]u'O=\";\"Sj0 $!IuT9Zv4g{B%x%N5C=)3#(yE,X?HUj(i{&gt;1y'%m&lt;LO{TF?kqiVqX(2ai?\\mluZ|%zSo(&lt;`9AD&gt;ABDX/p!lRnXBnZK{TCl~v%r+s]}Wu:dUdPRh$t=1\"cYW5ig-r#Vj--51re8}LT&amp;\\$6;qbax9E%=#$HR.&gt;7\\ IJ_K%HW +8SzW)'w;ax9E%=#$.WB$^^JxVcVsC3YB7\nduuKCQSJs&lt;L*qaZSpVMRsv%HW3IU;N]ek[c#9zj,lpLa-G&lt;Yv&lt;hxY])&gt;3!DQ,p~da\"]@[*rClxy19`B,gUfZZ?=8&lt;,&amp;vw)ke,l&gt;dDCyEt\nLwLBQ0LY)f}30)x3L&lt;\n#=Iv,GgZ^n\\11&amp;rg?X~#D]5QtMW*E/';E@Q[F%^;[Nj+Yu6~rrwl^ /vmgdVp2Tsge~8@#'dbax9E%=#$.f6}3zXFf:~i)wX?x:uUm1v\n*#&gt;UM&lt;otbzi:4\\V'ax9E%=#$ClG-Bg*j5O^\\jpqjnmA]no=y^!K]gXk?i'Ble\\,:tZJ6+39bZ4Wh1V}rO *n#aG_wKv!V#,mv^qf?2F)ax9E%=#$v;jbTd4se$1k+rog ~JC\nTvuw27OO$t/n\\11&amp;rg?X~#D]5Qts{D%z5l'N B'&lt;c-&gt;=\";\"Sj0 nQ&lt;4,k4Aax9E%=#$yf$&lt;[+wW|g'NmHUr.f6}3zXFS1a||v!.N/&lt;e*qBPkcN(\\t\n/@sQ\n{^wIkS3{l\n_P&lt;&lt;2&gt;?X'.ax9E%=#$dL=r:K@DnKfEmP+,7`f*+1w3_2hH\n^k)&lt;&lt;2&gt;?X'.fwI/Y.m.%HW3IU;NgFJ3ZA$$s'^. LB=nFCS.a)j)&gt;3!DQ,p]kGLt[:Pqx6pJ|!ffiP&gt;FWeY!MT&gt;0yi+&gt;\"H;I;$7{U&amp;C+JCTT&lt;6Hadp^~X&gt;G8C&amp;awBM+6#1t7L!q5i_{yX?-d#BfH?tXKK0C.L2RvFm+u#sl=h'U'o#C\\^~UJorpHsZ_n{X;cApU_{b9#]1z2DYGa9.J~(L%RAJ+i,5b0PWj2krZnQ/s++ +r~+Q_?H}5dQjq\"u?2)\nL6#-2BA8e}RuxuTp|5=|p*:J;0fnOh=}-Af4T7bVw5H*Gv~8HC$%sHeP2{tHYoa^]+J8,s7Kx-Z/T6z0P&amp;b)f5X1KR{N8}^h.yx-9=mS`o`^HMgz)3e/(TFtKsI&gt;$G\\]8X&amp;geCd/.-X+g!U+Z-/.l%Wt.Qp&amp;(K;MgIqhh[A-x%+o`CeA8OHO1thHCBQiP/SpPd1-z{V~^[{'SMVJmy^P|'{gWXg/Fw_rD}&lt;E?5[D6aqN}\"`3w]hcBgtUy.Kfe-pklHHbe8h&lt;Z7hR`=qP.k|_sWU!;Ca\\`G[L\\Q+}^Aa|w+rZ@p)eyk[P,!Tk@?6C;z;~,uAV+@(!L_J8VVI$!\"3N5-4w$HHbe8h&lt;ZNw7A67{)Z1^(?@%uyEB7\"YvkXI`A e!1%+o`CeA8trfw}!Za,?2g!'5CS=NT7uCRvVf24,[RcXxIr ^6"</span>
</pre><p>Content of the encrypted file <code>pt.c.enc</code>:</p>
<pre data-role="codeBlock" data-info="plain" class="language-plain">Y,}*a@F^d'=1$e:g!n&amp;x:L}U9(y8on+x+a:N2ym0 mQn+o#a)aaO4l+&lt;Y,}*a@F^P#q]/lJj."oE./].Ff!HS=af~|sakH#jRWVJ835\UY5sQtW+
,2s{]MNFbpN
f\qZ5&lt;YMfBKA9g\$q.4lx*K(i{R=?LCo`+[:LBKv91W&gt;Wu[0CT}.{%c[Wk-1L&lt;"R3M&lt;IU5
gIoK|]b4)0?&lt;7^:zBA@&amp;TM0m$^iV1TmhC2]0 bohxX.LS?4MTZ#m.V4XQ0jLE|8Zxg\*?eow2O
*3p}T(_3^|Jo6WsL&lt;~`5Uh/G?"ESG,KZ)s~)}XySr7L!q5i_{yX?-d#BfD rG8SyLoH2d]u'O=";"Sj0 $!IuT9Zv4g{B%x%N5C=)3#(yE,X?HUj(i{&gt;1y'%m&lt;LO{TF?kqiVqX(2ai?\mluZ|%zSo(&lt;`9AD&gt;ABDX/p!lRnXBnZK{TCl~v%r+s]}Wu:dUdPRh$t=1"cYW5ig-r#Vj--51re8}LT&amp;\$6;qbax9E%=#$HR.&gt;7\ IJ_K%HW +8SzW)'w;ax9E%=#$.WB$^^JxVcVsC3YB7
duuKCQSJs&lt;L*qaZSpVMRsv%HW3IU;N]ek[c#9zj,lpLa-G&lt;Yv&lt;hxY])&gt;3!DQ,p~da"]@[*rClxy19`B,gUfZZ?=8&lt;,&amp;vw)ke,l&gt;dDCyEt
LwLBQ0LY)f}30)x3L&lt;
#=Iv,GgZ^n\11&amp;rg?X~#D]5QtMW*E/';E@Q[F%^;[Nj+Yu6~rrwl^ /vmgdVp2Tsge~8@#'dbax9E%=#$.f6}3zXFf:~i)wX?x:uUm1v
*#&gt;UM&lt;otbzi:4\V'ax9E%=#$ClG-Bg*j5O^\jpqjnmA]no=y^!K]gXk?i'Ble\,:tZJ6+39bZ4Wh1V}rO *n#aG_wKv!V#,mv^qf?2F)ax9E%=#$v;jbTd4se$1k+rog ~JC
Tvuw27OO$t/n\11&amp;rg?X~#D]5Qts{D%z5l'N B'&lt;c-&gt;=";"Sj0 nQ&lt;4,k4Aax9E%=#$yf$&lt;[+wW|g'NmHUr.f6}3zXFS1a||v!.N/&lt;e*qBPkcN(\t
/@sQ
{^wIkS3{l
_P&lt;&lt;2&gt;?X'.ax9E%=#$dL=r:K@DnKfEmP+,7`f*+1w3_2hH
^k)&lt;&lt;2&gt;?X'.fwI/Y.m.%HW3IU;NgFJ3ZA$$s'^. LB=nFCS.a)j)&gt;3!DQ,p]kGLt[:Pqx6pJ|!ffiP&gt;FWeY!MT&gt;0yi+&gt;"H;I;$7{U&amp;C+JCTT&lt;6Hadp^~X&gt;G8C&amp;awBM+6#1t7L!q5i_{yX?-d#BfH?tXKK0C.L2RvFm+u#sl=h'U'o#C\^~UJorpHsZ_n{X;cApU_{b9#]1z2DYGa9.J~(L%RAJ+i,5b0PWj2krZnQ/s++ +r~+Q_?H}5dQjq"u?2)
L6#-2BA8e}RuxuTp|5=|p*:J;0fnOh=}-Af4T7bVw5H*Gv~8HC$%sHeP2{tHYoa^]+J8,s7Kx-Z/T6z0P&amp;b)f5X1KR{N8}^h.yx-9=mS`o`^HMgz)3e/(TFtKsI&gt;$G\]8X&amp;geCd/.-X+g!U+Z-/.l%Wt.Qp&amp;(K;MgIqhh[A-x%+o`CeA8OHO1thHCBQiP/SpPd1-z{V~^[{'SMVJmy^P|'{gWXg/Fw_rD}&lt;E?5[D6aqN}"`3w]hcBgtUy.Kfe-pklHHbe8h&lt;Z7hR`=qP.k|_sWU!;Ca\`G[L\Q+}^Aa|w+rZ@p)eyk[P,!Tk@?6C;z;~,uAV+@(!L_J8VVI$!"3N5-4w$HHbe8h&lt;ZNw7A67{)Z1^(?@%uyEB7"YvkXI`A e!1%+o`CeA8trfw}!Za,?2g!'5CS=NT7uCRvVf24,[RcXxIr ^6val it = () : unit
</pre><p>Assuming that the file contains the homework, assistant knows that the first 5 lines of the plaintext (corresponding to ciphertext <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span>) should be:</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token keyword keyword-val">val</span> x' <span class="token operator">=</span> <span class="token string">"#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;sys/types.h&gt;\n#include&lt;sys/wait.h&gt;\n"</span>
</pre><pre data-role="codeBlock" data-info="C" class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;sys/types.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;sys/wait.h&gt;</span></span>

</pre><p>The assistant also knows the encryption and decryption algorithm that students are using, but not the key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">K</span></span></span></span>. They are using <a href="https://en.wikipedia.org/wiki/Hill_cipher">Hill Cipher</a> with one-to-one integer encoding to the alphabet:</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token keyword keyword-val">val</span> alphabet <span class="token operator">=</span> <span class="token string">"\n !\"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"</span>
</pre><p>This means that each character of the plaintext is mapped to a number in set <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mn>96</mn></msub><mo>:</mo><mo>=</mo><mrow><mo fence="true">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>95</mn><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{Z}_{96} := \left \{0, 1, \dots, 95 \right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83889em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">96</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">95</span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span>, depending where is positioned in the alphabet. For example, the result of encoding a string <code>int a = 2;</code> is the list of integers <code>74,79,85,1,66,1,30,1,19</code>. Decoding is just the inverse of the encoding.</p>
<p>Hill cipher encryption is a function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi mathvariant="bold">K</mi></msub><mo>:</mo><msubsup><mi mathvariant="double-struck">Z</mi><mi mathvariant="double-struck">n</mi><mrow><mi mathvariant="double-struck">ℓ</mi><mo>×</mo><mi mathvariant="double-struck">ℓ</mi></mrow></msubsup><mo>×</mo><msubsup><mi mathvariant="double-struck">Z</mi><mi>n</mi><mi mathvariant="normal">ℓ</mi></msubsup><mo>→</mo><msubsup><mi mathvariant="double-struck">Z</mi><mi>n</mi><mi mathvariant="normal">ℓ</mi></msubsup></mrow><annotation encoding="application/x-tex">E_\mathbf{K} : \mathbb{Z_n^{\ell \times \ell}} \times \mathbb{Z}_n^\ell \rightarrow \mathbb{Z}_n^\ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33027699999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0961079999999999em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">ℓ</span><span class="mbin mtight">×</span><span class="mord mtight">ℓ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.096108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.096108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> defined as<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><msub><mi>E</mi><mi mathvariant="bold">K</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="bold">x</mi><mi mathvariant="bold">K</mi><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>n</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathbf{y} = E_{\mathbf{K}}(\mathbf{x}) = \mathbf{x} \mathbf{K} \bmod n,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33027699999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathbf">xK</span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord mathbf">x</span></span></span></span> is a block of plaintext (horizontal vector of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">ℓ</mi></mrow><annotation encoding="application/x-tex">\ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">ℓ</span></span></span></span> integers), <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">K</span></span></span></span> is a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">ℓ</mi></mrow><annotation encoding="application/x-tex">\ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">ℓ</span></span></span></span> by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">ℓ</mi></mrow><annotation encoding="application/x-tex">\ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">ℓ</span></span></span></span> matrix, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> is modulus. The result is a block of the ciphertext <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span> (horizontal vector of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">ℓ</mi></mrow><annotation encoding="application/x-tex">\ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">ℓ</span></span></span></span> integers). In other words encryption is a matrix multiplication (from the right) under commutative ring <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi mathvariant="double-struck">Z</mi><mi>n</mi></msub><mo separator="true">,</mo><msub><mo>+</mo><mi>n</mi></msub><mo separator="true">,</mo><msub><mo>∗</mo><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathbb{Z}_n, +_n, *_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mbin">+</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mbin">∗</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>. This is similar to commutative ring (also a field) over real numbers <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">\mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">R</span></span></span></span>. The difference is that we will only work with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> integers from set <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{Z}_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83889em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and that binary operations (addition and multiplication) are defined differently (while their properties are almost preserved).<br>
Operations in this commutative ring <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi mathvariant="double-struck">Z</mi><mi>n</mi></msub><mo separator="true">,</mo><msub><mo>+</mo><mi>n</mi></msub><mo separator="true">,</mo><msub><mo>∗</mo><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathbb{Z}_n, +_n, *_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mbin">+</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mbin">∗</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> are defined as follows (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo>∈</mo><msub><mi mathvariant="double-struck">Z</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">a, b \in \mathbb{Z}_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83889em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>):</p>
<ul>
<li>addition, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><msub><mo>+</mo><mi>n</mi></msub><mi>b</mi><mo>:</mo><mo>=</mo><mi>a</mi><mo>+</mo><mi>b</mi><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">a +_n b := a + b \bmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"><span class="mbin">+</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span></li>
<li>negation, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>neg</mtext><mi>n</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mo>−</mo><mi>a</mi><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">\text{neg}_n(a) := -a \bmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">neg</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span></li>
<li>multiplication, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><msub><mo>∗</mo><mi>n</mi></msub><mi>b</mi><mo>:</mo><mo>=</mo><mi>a</mi><mo>∗</mo><mi>b</mi><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">a *_n b := a * b \bmod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"><span class="mbin">∗</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span></li>
<li>inverse, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>inv</mtext><mi>n</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo></mrow><annotation encoding="application/x-tex">\text{inv}_n(a) :=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">inv</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:=</span></span></span></span> an element <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span> such that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>∗</mo><mi>a</mi><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>n</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">b * a \bmod n = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> (does not exist for every element of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{Z}_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83889em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)</li>
</ul>
<p>The binary operator <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext></mrow><annotation encoding="application/x-tex">\bmod</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.05555555555555555em;"></span></span></span></span> is reminder after integer division In SML NJ is named <code>mod : int * int -&gt; int</code>.<br>
If you wan to learn more look up <a href="https://en.wikipedia.org/wiki/Modular_arithmetic">Modular arithmetic</a>.</p>
<p>Summary (encryption):</p>
<ul>
<li>firstly the plaintext is encoded to the list of integers,</li>
<li>then this integers are divided into blocks (horizontal vectors) of equal size,</li>
<li>then each vector is multiplied by a matrix (according to ring <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{Z}_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83889em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>),</li>
<li>then vectors are assembled back into a the list of integers,</li>
<li>and in the end, the list is decoded into characters forming a ciphertext (sting).</li>
</ul>
<p>The decryption is reversed encryption process (instead of multiplying with matrix <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">K</span></span></span></span> we are multiplying with its inverse <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">K</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{K}^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>).</p>
<p>We will be using Standard ML to implement decryption, encryption and attacks on Hill cipher.</p>
<h2 class="mume-header" id="first-part-mdash-preparation-warm-up-exercise">First part — Preparation (warm up exercise)</h2>

<p>Whole implementation (modular arithmetic, Hill cipher, attacks, ...) will reside inside one file named <code>01-project.sml</code>. For a warm-up implement the following function.</p>
<ol>
<li>
<p>(✔️ 5 marks, 📜 6-8) <strong>split</strong> (<code>= int -&gt; 'a list -&gt; 'a list list</code>)<br>
Function takes number <code>blockSize</code> and a list and splits it into sub-lists/blocks of size <code>blockSize</code>. If the input list is not multiple of number <code>blockSize</code>, it discards the remaining elements after division.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> split <span class="token number">3</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> int list list
<span class="token operator">-</span> split <span class="token number">5</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> int list list
<span class="token operator">-</span> split <span class="token number">1</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> int list list
<span class="token operator">-</span> split <span class="token number">4</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> int list list
<span class="token operator">-</span> split <span class="token number">1</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> int list<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> int list list
</pre></li>
</ol>
<p>The header of the file <code>01-project.sml</code>.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token keyword keyword-val">val</span> <span class="token punctuation">_</span> <span class="token operator">=</span> <span class="token module variable">Control</span><span class="token punctuation">.</span><span class="token module variable">Print</span><span class="token punctuation">.</span>printDepth <span class="token operator">:=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> <span class="token punctuation">_</span> <span class="token operator">=</span> <span class="token module variable">Control</span><span class="token punctuation">.</span><span class="token module variable">Print</span><span class="token punctuation">.</span>printLength <span class="token operator">:=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> <span class="token punctuation">_</span> <span class="token operator">=</span> <span class="token module variable">Control</span><span class="token punctuation">.</span><span class="token module variable">Print</span><span class="token punctuation">.</span>stringDepth <span class="token operator">:=</span> <span class="token number">2000</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> <span class="token punctuation">_</span> <span class="token operator">=</span> <span class="token module variable">Control</span><span class="token punctuation">.</span>polyEqWarn <span class="token operator">:=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token comment">(* usefull for making unit tests *)</span>
<span class="token keyword keyword-fun">fun</span> readFile filename <span class="token operator">=</span>
  <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-val">val</span> is <span class="token operator">=</span> <span class="token module variable">TextIO</span><span class="token punctuation">.</span>openIn filename
  <span class="token keyword keyword-in">in</span> 
    <span class="token module variable">String</span><span class="token punctuation">.</span>map <span class="token punctuation">(</span>fn c <span class="token operator">=&gt;</span> <span class="token keyword keyword-if">if</span> <span class="token module variable">Char</span><span class="token punctuation">.</span>isGraph c orelse c <span class="token operator">=</span> #<span class="token string">" "</span> orelse c <span class="token operator">=</span> #<span class="token string">"\n"</span> <span class="token keyword keyword-then">then</span> c <span class="token keyword keyword-else">else</span> #<span class="token string">" "</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token module variable">TextIO</span><span class="token punctuation">.</span>inputAll is<span class="token punctuation">)</span>
    before <span class="token module variable">TextIO</span><span class="token punctuation">.</span>closeIn is
  <span class="token keyword keyword-end">end</span>

<span class="token comment">(* exception for non-implemented functions *)</span>
<span class="token keyword keyword-exception">exception</span> <span class="token module variable">NotImplemented</span><span class="token punctuation">;</span>
</pre><h2 class="mume-header" id="second-part-mdash-matrices-over-commutative-ring-mathbbz_n">Second part — Matrices over commutative ring <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{Z}_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83889em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></h2>

<p>First task is to implement a structure for representing arbitrary ring <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{Z}_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83889em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (for doing modular arithmetic). Such structure will have the following signature <code>RING</code>:</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml">signature <span class="token module variable">RING</span> <span class="token operator">=</span>
<span class="token keyword keyword-sig">sig</span>
  eqtype t
  <span class="token keyword keyword-val">val</span> zero <span class="token punctuation">:</span> t
  <span class="token keyword keyword-val">val</span> one <span class="token punctuation">:</span> t
  <span class="token keyword keyword-val">val</span> neg <span class="token punctuation">:</span> t <span class="token operator">-&gt;</span> t
  <span class="token keyword keyword-val">val</span> inv <span class="token punctuation">:</span> t <span class="token operator">-&gt;</span> t option
  <span class="token keyword keyword-val">val</span> <span class="token operator">+</span> <span class="token punctuation">:</span> t <span class="token operator">*</span> t <span class="token operator">-&gt;</span> t
  <span class="token keyword keyword-val">val</span> <span class="token operator">*</span> <span class="token punctuation">:</span> t <span class="token operator">*</span> t <span class="token operator">-&gt;</span> t
<span class="token keyword keyword-end">end</span>
</pre><p>It specifies elements <code>zero</code> (neutral element of addition) and <code>one</code> (unit for addition), and operations <code>neg</code> (additive inverse), <code>inv</code> (multiplicative inverse), <code>+</code> (addition) and <code>*</code> (multiplication).</p>
<p>Because we want to work with any modulus <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>, we will use a functor <code>Ring</code> that takes this integer <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> as an argument (actually it is a small structure containing only the value <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>) and returns a structure implementing specification <code>RING</code>.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token keyword keyword-functor">functor</span> <span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token punctuation">:</span> int<span class="token punctuation">)</span> <span class="token punctuation">:</span><span class="token operator">&gt;</span> <span class="token module variable">RING</span> <span class="token keyword keyword-where">where</span> <span class="token keyword keyword-type">type</span> t <span class="token operator">=</span> int <span class="token operator">=</span>
<span class="token keyword keyword-struct">struct</span>
  <span class="token keyword keyword-type">type</span> t <span class="token operator">=</span> int
  <span class="token keyword keyword-val">val</span> zero <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword keyword-val">val</span> one <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword keyword-fun">fun</span> neg x <span class="token operator">=</span> <span class="token label function">~x</span> <span class="token operator">mod</span> n

  <span class="token keyword keyword-fun">fun</span> modularInverse <span class="token punctuation">(</span>a<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">=</span> raise <span class="token module variable">NotImlemented</span>

  <span class="token keyword keyword-fun">fun</span> inv x <span class="token operator">=</span> modularInverse <span class="token punctuation">(</span>x <span class="token operator">mod</span> n<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
  <span class="token keyword keyword-fun">fun</span> op <span class="token operator">+</span> a <span class="token operator">=</span>  <span class="token module variable">Int</span><span class="token punctuation">.</span><span class="token operator">+</span> a <span class="token operator">mod</span> n
  <span class="token keyword keyword-fun">fun</span> op <span class="token operator">*</span> p <span class="token operator">=</span>  <span class="token module variable">Int</span><span class="token punctuation">.</span><span class="token operator">*</span> p <span class="token operator">mod</span> n
<span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>
</pre><p>Once we have implemented structures for modulo arithmetic we can implement structures for simple matrix/linear algebra. The structure for doing linear algebra will have the following signature <code>MAT</code>.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml">signature <span class="token module variable">MAT</span> <span class="token operator">=</span>
<span class="token keyword keyword-sig">sig</span>
  eqtype t
  structure <span class="token module variable">Vec</span> <span class="token punctuation">:</span>
    <span class="token keyword keyword-sig">sig</span>
      <span class="token keyword keyword-val">val</span> dot <span class="token punctuation">:</span> t list <span class="token operator">-&gt;</span> t list <span class="token operator">-&gt;</span> t
      <span class="token keyword keyword-val">val</span> add <span class="token punctuation">:</span> t list <span class="token operator">-&gt;</span> t list <span class="token operator">-&gt;</span> t list
      <span class="token keyword keyword-val">val</span> sub <span class="token punctuation">:</span> t list <span class="token operator">-&gt;</span> t list <span class="token operator">-&gt;</span> t list
      <span class="token keyword keyword-val">val</span> scale <span class="token punctuation">:</span> t <span class="token operator">-&gt;</span> t list <span class="token operator">-&gt;</span> t list
    <span class="token keyword keyword-end">end</span>
  <span class="token keyword keyword-val">val</span> tr <span class="token punctuation">:</span> t list list <span class="token operator">-&gt;</span> t list list
  <span class="token keyword keyword-val">val</span> mul <span class="token punctuation">:</span> t list list <span class="token operator">-&gt;</span> t list list <span class="token operator">-&gt;</span> t list list
  <span class="token keyword keyword-val">val</span> id <span class="token punctuation">:</span> int <span class="token operator">-&gt;</span> t list list
  <span class="token keyword keyword-val">val</span> join <span class="token punctuation">:</span> t list list <span class="token operator">-&gt;</span> t list list <span class="token operator">-&gt;</span> t list list
  <span class="token keyword keyword-val">val</span> inv <span class="token punctuation">:</span> t list list <span class="token operator">-&gt;</span> t list list option
<span class="token keyword keyword-end">end</span>
</pre><p>Such structure will have also sub-structure <code>Vec</code> for vector-wise operations. Because we want to work with matrices over any ring, we will implement a functor <code>Mat</code> that takes a <code>RING</code> structure as an argument and returns a structure that implements specification <code>MAT</code>.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token keyword keyword-functor">functor</span> <span class="token module variable">Mat</span> <span class="token punctuation">(</span>R <span class="token punctuation">:</span> <span class="token module variable">RING</span><span class="token punctuation">)</span> <span class="token punctuation">:</span><span class="token operator">&gt;</span> <span class="token module variable">MAT</span> <span class="token keyword keyword-where">where</span> <span class="token keyword keyword-type">type</span> t <span class="token operator">=</span> R<span class="token punctuation">.</span>t <span class="token operator">=</span>
<span class="token keyword keyword-struct">struct</span>
  <span class="token comment">(* implementation is missing *)</span>
<span class="token keyword keyword-end">end</span>
</pre><p>Functions that you need to implement for the second part are:</p>
<ol>
<li>
<p>(✔️ 5 marks, 📜 2-6) <strong>modularInverse</strong> (<code>= int * int -&gt; int option</code>, inside functor <code>Ring</code>)<br>
Function takes number <code>a</code> and modulus <code>n</code> and returns its inverse if it exists (return type is <code>int option</code>). You can implement this using extended Euclidean algorithm (<a href="https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm#Modular_integers">pseudo-code</a>, recommended) or by trying every element (in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{Z}_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83889em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) for the inverse.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure <span class="token module variable">Z96</span> <span class="token operator">=</span> <span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">96</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure <span class="token module variable">Z96</span> <span class="token punctuation">:</span> <span class="token module variable">RING</span><span class="token operator">?</span>
<span class="token operator">-</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>inv<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>t <span class="token operator">-&gt;</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>t option
<span class="token operator">-</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>inv <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>t option
<span class="token operator">-</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>inv <span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token number">95</span> <span class="token punctuation">:</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>t option
<span class="token operator">-</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>inv <span class="token number">11</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token number">35</span> <span class="token punctuation">:</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>t option
<span class="token operator">-</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>inv <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>t option
<span class="token operator">-</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>inv <span class="token number">31</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token number">31</span> <span class="token punctuation">:</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>t option
<span class="token operator">-</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>inv <span class="token number">1337</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token number">41</span> <span class="token punctuation">:</span> <span class="token module variable">Z96</span><span class="token punctuation">.</span>t option
</pre></li>
<li>
<p>(✔️ 2 marks, 📜 1) <strong>add</strong> (<code>= t list -&gt; t list -&gt; t list</code>, inside functor <code>Mat</code> inside structure <code>Vec</code>)<br>
Adds two vectors under the ring <code>R</code>.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure M <span class="token operator">=</span> <span class="token module variable">Mat</span> <span class="token punctuation">(</span><span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure M <span class="token punctuation">:</span> <span class="token module variable">MAT</span><span class="token operator">?</span>
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>add<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>add <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token operator">~</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>add <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list
</pre></li>
<li>
<p>(✔️ 2 marks, 📜 1) <strong>sub</strong> (<code>= t list -&gt; t list -&gt; t list</code>, inside functor <code>Mat</code> inside structure <code>Vec</code>)<br>
Subtract two vectors under the ring <code>R</code>.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure M <span class="token operator">=</span> <span class="token module variable">Mat</span> <span class="token punctuation">(</span><span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure M <span class="token punctuation">:</span> <span class="token module variable">MAT</span><span class="token operator">?</span>
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>sub<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>sub <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token operator">~</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>sub <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list
</pre></li>
<li>
<p>(✔️ 3 marks, 📜 1) <strong>scale</strong> (<code>= t -&gt; t list -&gt; t list</code>, inside functor <code>Mat</code> inside structure <code>Vec</code>)<br>
Scalar multiplication of a vector and an element under the ring <code>R</code>.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure M <span class="token operator">=</span> <span class="token module variable">Mat</span> <span class="token punctuation">(</span><span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure M <span class="token punctuation">:</span> <span class="token module variable">MAT</span><span class="token operator">?</span>
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>scale<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>scale <span class="token number">9</span> <span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token operator">~</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>scale <span class="token operator">~</span><span class="token number">1</span> <span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token operator">~</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>scale <span class="token number">0</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list
</pre></li>
<li>
<p>(✔️ 2 marks, 📜 1) <strong>dot</strong> (<code>= t list -&gt; t list -&gt; t</code>, inside functor <code>Mat</code> inside structure <code>Vec</code>)<br>
Scalar product of two vectors under the ring <code>R</code>.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure M <span class="token operator">=</span> <span class="token module variable">Mat</span> <span class="token punctuation">(</span><span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure M <span class="token punctuation">:</span> <span class="token module variable">MAT</span><span class="token operator">?</span>
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>dot<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>dot <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token operator">~</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>dot <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t
<span class="token operator">-</span> M<span class="token punctuation">.</span><span class="token module variable">Vec</span><span class="token punctuation">.</span>dot <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t
</pre></li>
<li>
<p>(✔️ 2 marks, 📜 2) <strong>tr</strong> (<code>= t list list -&gt; t list list</code>, inside functor <code>Mat</code>)<br>
Transpose of a matrix.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure M <span class="token operator">=</span> <span class="token module variable">Mat</span> <span class="token punctuation">(</span><span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure M <span class="token punctuation">:</span> <span class="token module variable">MAT</span><span class="token operator">?</span>
<span class="token operator">-</span> M<span class="token punctuation">.</span>tr<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>tr <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>tr <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>tr <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>tr <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
</pre></li>
<li>
<p>(✔️ 2 marks, 📜 1) <strong>mul</strong> (<code>= t list list -&gt; t list list -&gt; t list list</code>, inside functor <code>Mat</code>)<br>
Multiplication of two matrices under the ring <code>R</code>.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure M <span class="token operator">=</span> <span class="token module variable">Mat</span> <span class="token punctuation">(</span><span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure M <span class="token punctuation">:</span> <span class="token module variable">MAT</span><span class="token operator">?</span>
<span class="token operator">-</span> M<span class="token punctuation">.</span>mul<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>mul <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>mul <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>mul <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>mul <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>mul <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>mul <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
</pre></li>
<li>
<p>(✔️ 4 marks, 📜 3) <strong>join</strong> (<code>= t list list -&gt; t list list -&gt; t list list</code>, inside functor <code>Mat</code>)<br>
Connects two matrices horizontally.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure M <span class="token operator">=</span> <span class="token module variable">Mat</span> <span class="token punctuation">(</span><span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure M <span class="token punctuation">:</span> <span class="token module variable">MAT</span><span class="token operator">?</span>
<span class="token operator">-</span> M<span class="token punctuation">.</span>join<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>join <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>join <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
</pre></li>
<li>
<p>(✔️ 4 marks, 📜 3) <strong>id</strong> (<code>= int -&gt; t list list</code>, inside functor <code>Mat</code>)<br>
Return identity matrix of size <code>n</code> under the ring <code>R</code>.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure M <span class="token operator">=</span> <span class="token module variable">Mat</span> <span class="token punctuation">(</span><span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure M <span class="token punctuation">:</span> <span class="token module variable">MAT</span><span class="token operator">?</span>
<span class="token operator">-</span> M<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> int <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>id <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>id <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
<span class="token operator">-</span> M<span class="token punctuation">.</span>id <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list
</pre></li>
<li>
<p>(✔️ 15 marks, 📜 12-16) <strong>inv</strong> (<code>= t list list -&gt; t list list option</code>, inside functor <code>Mat</code>)<br>
Computes the inverse of a square matrix under the ring <code>R</code> if it exists. If matrix is non-square, the result can vary. One of the algorithm for computing inverse of matrix <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">A</span></span></span></span> goes as follows:</p>
<ul>
<li>Add identity matrix to the left of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">A</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">A</mi><mo mathvariant="bold" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mrow><mo fence="true">[</mo><mi mathvariant="bold">A</mi><mo>∣</mo><mi mathvariant="bold">I</mi><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{A'} = \left[\mathbf{A} \mid \mathbf{I}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord mathbf">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathbf">I</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span>.</li>
<li>Do the <a href="https://en.wikipedia.org/wiki/Gaussian_elimination">Gaussian elimination</a> on matrix <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">A</span></span></span></span>.</li>
<li>If <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">A</span></span></span></span> is invertible matrix, you will get the inverse on the right side after Gaussian elimination algorithm on <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">A</mi><mo mathvariant="bold" lspace="0em" rspace="0em">′</mo></msup><msub><mo>∼</mo><mtext>Gauss</mtext></msub><mo stretchy="false">[</mo><mi mathvariant="bold">I</mi><mo>∣</mo><msup><mi mathvariant="bold">A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">]</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathbf{A'} \sim_\text{Gauss} [\mathbf{I} \mid \mathbf{A}^{-1}].</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.901892em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel">∼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">Gauss</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathbf">I</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord">.</span></span></span></span></li>
</ul>
<p>Since we only want to compute the inverse we can simplify the Gaussian elimination (this algorithm will be presented on the tutorials) — <strong>this algorithm will sometimes fail to find the inverse, even if it exists! (more on tutorials)</strong>.</p>
<p>Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure M <span class="token operator">=</span> <span class="token module variable">Mat</span> <span class="token punctuation">(</span><span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure M <span class="token punctuation">:</span> <span class="token module variable">MAT</span><span class="token operator">?</span>
<span class="token operator">-</span> M<span class="token punctuation">.</span>inv<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list <span class="token operator">-&gt;</span> M<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> M<span class="token punctuation">.</span>inv <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">~</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> M<span class="token punctuation">.</span>inv <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> M<span class="token punctuation">.</span>inv <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> M<span class="token punctuation">.</span>inv <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> M<span class="token punctuation">.</span>inv <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> M<span class="token punctuation">.</span>inv <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> M<span class="token punctuation">.</span>inv <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list option
</pre></li>
</ol>
<h3 class="mume-header" id="special-functor-integermodringmat">Special functor <code>IntegerModRingMat</code></h3>

<p>Finding an inverse of a matrix over arbitrary commutative Ring is not simple. Previous implementation of function <code>inv</code> only works sometimes. For example:</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure M <span class="token operator">=</span> <span class="token module variable">Mat</span> <span class="token punctuation">(</span><span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">-</span> structure <span class="token module variable">M2</span> <span class="token operator">=</span> <span class="token module variable">IntegerModRingMat</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token keyword keyword-val">val</span> m <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token operator">-</span> M<span class="token punctuation">.</span>inv m<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> M<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> <span class="token module variable">M2</span><span class="token punctuation">.</span>inv m<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token module variable">M2</span><span class="token punctuation">.</span>t list list option
</pre><p>But if we are working with ring <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi mathvariant="double-struck">Z</mi><mi>n</mi></msub><mo separator="true">,</mo><msub><mo>+</mo><mi>n</mi></msub><mo separator="true">,</mo><msub><mo>∗</mo><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathbb{Z}_n, +_n, *_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathbb">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mbin">+</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mbin">∗</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, we can fully implement the inverse function (function <code>inv</code> will always find the inverse matrix if it exist). Functor <code>IntegerModRingMat</code> implements this functionality. The only problem with the following solution is high computational complexity.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml">structure <span class="token module variable">RationalFiled</span> <span class="token punctuation">:</span><span class="token operator">&gt;</span> <span class="token module variable">RING</span> <span class="token keyword keyword-where">where</span> <span class="token keyword keyword-type">type</span> t <span class="token operator">=</span> <span class="token module variable">IntInf</span><span class="token punctuation">.</span>int <span class="token operator">*</span> <span class="token module variable">IntInf</span><span class="token punctuation">.</span>int <span class="token operator">=</span>
<span class="token keyword keyword-struct">struct</span>
  <span class="token comment">(* (a, b) &lt;=&gt; a/b *)</span>
  <span class="token keyword keyword-type">type</span> t <span class="token operator">=</span> <span class="token module variable">IntInf</span><span class="token punctuation">.</span>int <span class="token operator">*</span> <span class="token module variable">IntInf</span><span class="token punctuation">.</span>int
  <span class="token keyword keyword-open">open</span> <span class="token module variable">IntInf</span>
  <span class="token keyword keyword-val">val</span> zero <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> t
  <span class="token keyword keyword-val">val</span> one <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> t
  <span class="token keyword keyword-fun">fun</span> neg <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token label function">~a</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
  <span class="token keyword keyword-fun">fun</span> inv <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">_</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> t<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token module variable">NONE</span>
    <span class="token operator">|</span> inv <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token punctuation">)</span>
  <span class="token keyword keyword-fun">fun</span> gcd <span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> a
    <span class="token operator">|</span> gcd <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=</span> gcd <span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">mod</span> b<span class="token punctuation">)</span>
  <span class="token keyword keyword-fun">fun</span> rat <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=</span> 
    <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-val">val</span> d <span class="token operator">=</span> gcd <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token keyword keyword-in">in</span> <span class="token punctuation">(</span>a div d<span class="token punctuation">,</span> b div d<span class="token punctuation">)</span> <span class="token keyword keyword-end">end</span>

  <span class="token keyword keyword-fun">fun</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-open">open</span> <span class="token module variable">IntInf</span> <span class="token keyword keyword-in">in</span> rat <span class="token punctuation">(</span>a <span class="token operator">*</span> d <span class="token operator">+</span> c <span class="token operator">*</span> b<span class="token punctuation">,</span> b <span class="token operator">*</span> d<span class="token punctuation">)</span> <span class="token keyword keyword-end">end</span>
  <span class="token keyword keyword-fun">fun</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-open">open</span> <span class="token module variable">IntInf</span> <span class="token keyword keyword-in">in</span> rat <span class="token punctuation">(</span>a <span class="token operator">*</span> c<span class="token punctuation">,</span> b <span class="token operator">*</span> d<span class="token punctuation">)</span> <span class="token keyword keyword-end">end</span>
<span class="token keyword keyword-end">end</span>

<span class="token keyword keyword-functor">functor</span> <span class="token module variable">IntegerModRingMat</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token punctuation">:</span> int<span class="token punctuation">)</span> <span class="token punctuation">:</span><span class="token operator">&gt;</span> <span class="token module variable">MAT</span> <span class="token keyword keyword-where">where</span> <span class="token keyword keyword-type">type</span> t <span class="token operator">=</span> int <span class="token operator">=</span>
<span class="token keyword keyword-struct">struct</span>
  structure R <span class="token operator">=</span> <span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> n<span class="token punctuation">)</span>
  structure M <span class="token operator">=</span> <span class="token module variable">Mat</span> <span class="token punctuation">(</span>R<span class="token punctuation">)</span>
  structure <span class="token module variable">QM</span> <span class="token operator">=</span> <span class="token module variable">Mat</span> <span class="token punctuation">(</span><span class="token module variable">RationalFiled</span><span class="token punctuation">)</span>

  <span class="token keyword keyword-open">open</span> M

  <span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token module variable">IntInf</span><span class="token punctuation">.</span>fromInt n
  <span class="token keyword keyword-fun">fun</span> bmod x <span class="token operator">=</span> <span class="token module variable">IntInf</span><span class="token punctuation">.</span>toInt <span class="token punctuation">(</span><span class="token module variable">IntInf</span><span class="token punctuation">.</span><span class="token operator">mod</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token keyword keyword-fun">fun</span> inv m <span class="token operator">=</span>
    <span class="token module variable">Option</span><span class="token punctuation">.</span>map
      <span class="token punctuation">(</span>fn m <span class="token operator">=&gt;</span>
        map <span class="token punctuation">(</span>map <span class="token punctuation">(</span>fn <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> R<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token punctuation">(</span>bmod a<span class="token punctuation">,</span> valOf <span class="token punctuation">(</span>R<span class="token punctuation">.</span>inv <span class="token punctuation">(</span>bmod b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> m<span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token module variable">QM</span><span class="token punctuation">.</span>inv <span class="token punctuation">(</span>map <span class="token punctuation">(</span>map <span class="token punctuation">(</span>fn x <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token module variable">IntInf</span><span class="token punctuation">.</span>fromInt x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> m<span class="token punctuation">)</span><span class="token punctuation">)</span>
    handle <span class="token module variable">Option</span> <span class="token operator">=&gt;</span> <span class="token module variable">NONE</span>
<span class="token keyword keyword-end">end</span>
</pre><h2 class="mume-header" id="third-part-mdash-hill-cipher">Third part — Hill Cipher</h2>

<p>We will use a functor <code>HillCipherAnalyzer</code> for the core functionality of a Hill cipher. It takes a structure <code>M : MAT</code> as an argument and returns a structure, implementing signature <code>CIPHER</code>.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml">signature <span class="token module variable">CIPHER</span> <span class="token operator">=</span>
<span class="token keyword keyword-sig">sig</span>
  <span class="token keyword keyword-type">type</span> t
  <span class="token keyword keyword-val">val</span> encrypt <span class="token punctuation">:</span> t list list <span class="token operator">-&gt;</span> t list <span class="token operator">-&gt;</span> t list
  <span class="token keyword keyword-val">val</span> decrypt <span class="token punctuation">:</span> t list list <span class="token operator">-&gt;</span> t list <span class="token operator">-&gt;</span> t list option
  <span class="token keyword keyword-val">val</span> knownPlaintextAttack <span class="token punctuation">:</span> int <span class="token operator">-&gt;</span> t list <span class="token operator">-&gt;</span> t list <span class="token operator">-&gt;</span> t list list option
<span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>

<span class="token keyword keyword-functor">functor</span> <span class="token module variable">HillCipherAnalyzer</span> <span class="token punctuation">(</span>M <span class="token punctuation">:</span> <span class="token module variable">MAT</span><span class="token punctuation">)</span> <span class="token punctuation">:</span><span class="token operator">&gt;</span> <span class="token module variable">CIPHER</span> <span class="token keyword keyword-where">where</span> <span class="token keyword keyword-type">type</span> t <span class="token operator">=</span> M<span class="token punctuation">.</span>t <span class="token operator">=</span>
<span class="token keyword keyword-struct">struct</span>
  <span class="token keyword keyword-type">type</span> t <span class="token operator">=</span> M<span class="token punctuation">.</span>t
  <span class="token keyword keyword-fun">fun</span> encrypt key plaintext <span class="token operator">=</span> raise <span class="token module variable">NotImlemented</span>
  <span class="token keyword keyword-fun">fun</span> decrypt key ciphertext <span class="token operator">=</span> raise <span class="token module variable">NotImlemented</span>
  <span class="token keyword keyword-fun">fun</span> knownPlaintextAttack keyLenght plaintext ciphertext <span class="token operator">=</span> raise <span class="token module variable">NotImlemented</span>
<span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>
</pre><ol>
<li>
<p>(✔️ 5 marks, 📜 1-2) <strong>encrypt</strong> (<code>= t list list -&gt; t list -&gt; t list</code>, inside functor <code>HillCipherAnalyzer</code>)<br>
Function takes a key, and an encoded plaintext and returns the ciphertext. You can use function <code>split</code>.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure C <span class="token operator">=</span> <span class="token module variable">HillCipherAnalyzer</span> <span class="token punctuation">(</span><span class="token module variable">Mat</span> <span class="token punctuation">(</span><span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure C <span class="token punctuation">:</span> <span class="token module variable">CIPHER</span><span class="token operator">?</span>
<span class="token operator">-</span> C<span class="token punctuation">.</span>encrypt<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list list <span class="token operator">-&gt;</span> C<span class="token punctuation">.</span>t list <span class="token operator">-&gt;</span> C<span class="token punctuation">.</span>t list
<span class="token operator">-</span> C<span class="token punctuation">.</span>encrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list
<span class="token operator">-</span> C<span class="token punctuation">.</span>encrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list
<span class="token operator">-</span> C<span class="token punctuation">.</span>encrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list
<span class="token operator">-</span> C<span class="token punctuation">.</span>encrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list
</pre></li>
<li>
<p>(✔️ 5 marks, 📜 1-3) <strong>decrypt</strong> (<code>= t list list -&gt; t list -&gt; t list option</code>, inside functor <code>HillCipherAnalyzer</code>)<br>
Function takes a key, and an encoded ciphertext and returns the plaintext. You can use function <code>split</code>.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure C <span class="token operator">=</span> <span class="token module variable">HillCipherAnalyzer</span> <span class="token punctuation">(</span><span class="token module variable">Mat</span> <span class="token punctuation">(</span><span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure C <span class="token punctuation">:</span> <span class="token module variable">CIPHER</span><span class="token operator">?</span>
<span class="token operator">-</span> C<span class="token punctuation">.</span>decrypt<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list list <span class="token operator">-&gt;</span> C<span class="token punctuation">.</span>t list <span class="token operator">-&gt;</span> C<span class="token punctuation">.</span>t list option
<span class="token operator">-</span> C<span class="token punctuation">.</span>decrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list option
<span class="token operator">-</span> C<span class="token punctuation">.</span>decrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list option
<span class="token operator">-</span> C<span class="token punctuation">.</span>decrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list option
<span class="token operator">-</span> C<span class="token punctuation">.</span>decrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list option
<span class="token operator">-</span> C<span class="token punctuation">.</span>decrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list option
</pre></li>
<li>
<p>(✔️ 13 marks, 📜 9-12) <strong>knownPlaintextAttack</strong> (<code>= : int -&gt; t list -&gt; t list -&gt; t list list option</code>, inside functor <code>HillCipherAnalyzer</code>)<br>
Function takes the length of a key, an encoded ciphertext and a plaintext, and returns the key. You can use function <code>split</code>. There are several ways how to solve this problem efficiently (trying every possible key is not an option). The following one is the the easiest:</p>
<ol>
<li>Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span> be the key length and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> the ring implicitly defined by structure <code>M</code>. Start with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span> blocks of plaintext and ciphertext.</li>
<li>Try to solve the matrix equation <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold">X</mi><mi mathvariant="bold">K</mi><mo>=</mo><mi mathvariant="bold">Y</mi><mo separator="true">,</mo><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo separator="true">,</mo><mi mathvariant="bold">Y</mi><mo separator="true">,</mo><mi mathvariant="bold">K</mi><mo>∈</mo><msup><mi>R</mi><mrow><mi>t</mi><mo>×</mo><mi>t</mi></mrow></msup><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathbf{X} \mathbf{K} = \mathbf{Y}, \quad (\mathbf{X}, \mathbf{Y}, \mathbf{K} \in R^{t \times t}),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">XK</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbf" style="margin-right:0.02875em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathbf" style="margin-right:0.02875em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathbf">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.093556em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span> where rows of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">X</span></span></span></span> are blocks the plaintext and rows of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Y</mi></mrow><annotation encoding="application/x-tex">\mathbf{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span></span></span> are blocks the ciphertext. If <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">X</span></span></span></span> is invertible matrix, then key <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">K</span></span></span></span> can be computed as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi><mo>=</mo><msup><mi mathvariant="bold">X</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant="bold">Y</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}=\mathbf{X}^{-1} \mathbf{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span></span></span>. If this is not the case continue to step 3.</li>
<li>Add a new row (the next block of the plaintext) to matrix <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">X</span></span></span></span> forming a matrix <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">X</mi><mtext>new</mtext></msub><mo>:</mo><mo>=</mo><mrow><mo fence="true">[</mo><mfrac><mi mathvariant="bold">X</mi><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mfrac><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{X}_{\text{new}} := \left[\frac{\mathbf{X}}{\mathbf{x}_{t+1}}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">new</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874277em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173142857142857em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20252142857142857em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.486765em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">]</span></span></span></span></span></span> (and similarly for matrix of ciphertexts for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">Y</mi><mtext>new</mtext></msub><mo>:</mo><mo>=</mo><mrow><mo fence="true">[</mo><mfrac><mi mathvariant="bold">Y</mi><msub><mi mathvariant="bold">y</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mfrac><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{Y}_{\text{new}} := \left[\frac{\mathbf{Y}}{\mathbf{y}_{t+1}}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02875em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">new</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874277em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173142857142857em;"><span style="top:-2.357em;margin-left:-0.01597em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20252142857142857em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.02875em;">Y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.486765em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">]</span></span></span></span></span></span>).</li>
<li>If matrix <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="bold">X</mi><mtext>new</mtext><mo>⊺</mo></msubsup><msub><mi mathvariant="bold">X</mi><mtext>new</mtext></msub></mrow><annotation encoding="application/x-tex">\mathbf{X}_{\text{new}}^\intercal \mathbf{X}_{\text{new}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.93311em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">new</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin amsrm mtight">⊺</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">new</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is invertible, then <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold">K</mi><mo>=</mo><msup><mrow><mo fence="true">(</mo><msubsup><mi mathvariant="bold">X</mi><mtext>new</mtext><mo>⊺</mo></msubsup><msub><mi mathvariant="bold">X</mi><mtext>new</mtext></msub><mo fence="true">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msubsup><mi mathvariant="bold">X</mi><mtext>new</mtext><mo>⊺</mo></msubsup><msub><mi mathvariant="bold">Y</mi><mtext>new</mtext></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathbf{K} = \left(\mathbf{X}_{\text{new}}^\intercal \mathbf{X}_{\text{new}}\right)^{-1} \mathbf{X}_{\text{new}}^\intercal\mathbf{Y}_{\text{new}},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord mathbf">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">new</span></span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin amsrm mtight">⊺</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">new</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">new</span></span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin amsrm mtight">⊺</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02875em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">new</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> otherwise go to step 3.</li>
<li>If you have reached the end of the ciphertext/plaintext, then finding a key was unsuccessful.</li>
</ol>
<p>If you have found the key, you need to validate it against the rest of the plaintext/ciphertext. If anything goes wrong return <code>NONE</code> (plaintext is not the same length as ciphertext, plaintext is not divisible by the length of the key, ...).</p>
<p>Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> C<span class="token punctuation">.</span>knownPlaintextAttack<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> int <span class="token operator">-&gt;</span> C<span class="token punctuation">.</span>t list <span class="token operator">-&gt;</span> C<span class="token punctuation">.</span>t list <span class="token operator">-&gt;</span> C<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> C<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">2</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> C<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">2</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> C<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">1</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> C<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">1</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> C<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">1</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list list option <span class="token comment">(* NONE is also fine *)</span>
<span class="token operator">-</span> C<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">1</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> C<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">3</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list list option <span class="token comment">(* solution is not unique *)</span>
<span class="token operator">-</span> C<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">3</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> C<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">3</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> C<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">3</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> C<span class="token punctuation">.</span>t list list option
</pre></li>
</ol>
<h2 class="mume-header" id="fourth-part-mdash-dictionary">Fourth part — Dictionary</h2>

<p>Sometimes we only have a ciphertext to work with. In this case, we can do an exhaustive search over all possible keys. The problem is that we do not know which key is correct. If we know that plain text is an English text, we can count the number of English words for each decryption, and choose a key that produces the most English words. For this type of an attack we need a structure that efficiently implements dictionary lookups.<br>
The following structure is a type of a tree for storing sequences (e.g sequences of letters — words → dictionary). Each node (made with constructor <code>N</code>) holds the following information:</p>
<ul>
<li>an element of the sequence (e.g a character),</li>
<li>a flag that denotes the end of the sequence (so we can have nested sequences, e.g "Anamaria" and "Ana"),</li>
<li>and a list of possible continuations for the current sequence.</li>
</ul>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml">structure <span class="token module variable">Trie</span> <span class="token punctuation">:</span><span class="token operator">&gt;</span> 
<span class="token keyword keyword-sig">sig</span>
  eqtype '<span class="token type-variable function">'a</span> dict
  <span class="token keyword keyword-val">val</span> empty <span class="token punctuation">:</span> '<span class="token type-variable function">'a</span> dict
  <span class="token keyword keyword-val">val</span> insert <span class="token punctuation">:</span> '<span class="token type-variable function">'a</span> list <span class="token operator">-&gt;</span> '<span class="token type-variable function">'a</span> dict <span class="token operator">-&gt;</span> '<span class="token type-variable function">'a</span> dict
  <span class="token keyword keyword-val">val</span> lookup <span class="token punctuation">:</span> '<span class="token type-variable function">'a</span> list <span class="token operator">-&gt;</span> '<span class="token type-variable function">'a</span> dict <span class="token operator">-&gt;</span> bool
<span class="token keyword keyword-end">end</span>
<span class="token operator">=</span>
<span class="token keyword keyword-struct">struct</span>
  datatype '<span class="token type-variable function">'a</span> tree <span class="token operator">=</span> N <span class="token keyword keyword-of">of</span> '<span class="token type-variable function">'a</span> <span class="token operator">*</span> bool <span class="token operator">*</span> '<span class="token type-variable function">'a</span> tree list
  <span class="token keyword keyword-type">type</span> '<span class="token type-variable function">'a</span> dict <span class="token operator">=</span> '<span class="token type-variable function">'a</span> tree list

  <span class="token keyword keyword-val">val</span> empty <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> '<span class="token type-variable function">'a</span> dict
  <span class="token keyword keyword-fun">fun</span> insert word dict <span class="token operator">=</span> raise <span class="token module variable">NotImlemented</span>
  <span class="token keyword keyword-fun">fun</span> lookup word dict <span class="token operator">=</span> raise <span class="token module variable">NotImlemented</span>
<span class="token keyword keyword-end">end</span>
</pre><ol>
<li>
<p>(✔️ 5 marks, 📜 5-7) <strong>insert</strong> (<code>= ''a list -&gt; ''a dict -&gt; ''a dict</code>, inside structure <code>Trie</code>)<br>
Function takes a sequence in a form of a list and inserts it into the tree.<br>
Examples (for testing purposes remove the signature).</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>insert<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> '<span class="token type-variable function">'a</span> list <span class="token operator">-&gt;</span> '<span class="token type-variable function">'a</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>dict <span class="token operator">-&gt;</span> '<span class="token type-variable function">'a</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>dict
<span class="token operator">-</span> <span class="token keyword keyword-val">val</span> t <span class="token operator">=</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>insert <span class="token punctuation">(</span><span class="token module variable">String</span><span class="token punctuation">.</span>explode <span class="token string">"Anamaria"</span><span class="token punctuation">)</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>empty<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> t <span class="token operator">=</span>
  <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"A"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"n"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"m"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"r"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"i"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">:</span> char <span class="token module variable">Trie</span><span class="token punctuation">.</span>tree list
<span class="token operator">-</span> <span class="token keyword keyword-val">val</span> t <span class="token operator">=</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>insert <span class="token punctuation">(</span><span class="token module variable">String</span><span class="token punctuation">.</span>explode <span class="token string">"Ana"</span><span class="token punctuation">)</span> t<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> t <span class="token operator">=</span>
  <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"A"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"n"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"m"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"r"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"i"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">:</span> char <span class="token module variable">Trie</span><span class="token punctuation">.</span>tree list
<span class="token operator">-</span> <span class="token keyword keyword-val">val</span> t <span class="token operator">=</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>insert <span class="token punctuation">(</span><span class="token module variable">String</span><span class="token punctuation">.</span>explode <span class="token string">"Alice"</span><span class="token punctuation">)</span> t<span class="token punctuation">;</span> <span class="token keyword keyword-val">val</span> t <span class="token operator">=</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"A"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"n"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"m"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"r"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"i"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> N <span class="token punctuation">(</span>#<span class="token string">"l"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"i"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"c"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"e"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">:</span> char <span class="token module variable">Trie</span><span class="token punctuation">.</span>tree list
<span class="token operator">-</span> <span class="token keyword keyword-val">val</span> t <span class="token operator">=</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>insert <span class="token punctuation">(</span><span class="token module variable">String</span><span class="token punctuation">.</span>explode <span class="token string">"Alan"</span><span class="token punctuation">)</span> t<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> t <span class="token operator">=</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"A"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"n"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"m"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"r"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"i"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> N <span class="token punctuation">(</span>#<span class="token string">"l"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"i"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"c"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"e"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"n"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">:</span> char <span class="token module variable">Trie</span><span class="token punctuation">.</span>tree list
<span class="token operator">-</span> <span class="token keyword keyword-val">val</span> t <span class="token operator">=</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>insert <span class="token punctuation">[</span>#<span class="token string">"A"</span><span class="token punctuation">]</span> t<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> t <span class="token operator">=</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"A"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"n"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"m"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"r"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"i"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> N <span class="token punctuation">(</span>#<span class="token string">"l"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"i"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"c"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"e"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> N <span class="token punctuation">(</span>#<span class="token string">"a"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token punctuation">[</span>N <span class="token punctuation">(</span>#<span class="token string">"n"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">:</span> char <span class="token module variable">Trie</span><span class="token punctuation">.</span>tree list
</pre></li>
<li>
<p>(✔️ 5 marks, 📜 4-7) <strong>lookup</strong> (<code>= ''a list -&gt; ''a dict -&gt; bool</code>, inside structure <code>Trie</code>)<br>
Function check if a given sequence is stored in the tree.<br>
Examples (we are using the tree <code>t</code> from previous examples).</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>lookup<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> '<span class="token type-variable function">'a</span> list <span class="token operator">-&gt;</span> '<span class="token type-variable function">'a</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>dict <span class="token operator">-&gt;</span> bool
<span class="token operator">-</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>lookup <span class="token punctuation">[</span>#<span class="token string">"A"</span><span class="token punctuation">]</span> t<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token punctuation">:</span> bool
<span class="token operator">-</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>lookup <span class="token punctuation">(</span><span class="token module variable">String</span><span class="token punctuation">.</span>explode <span class="token string">"Ana"</span><span class="token punctuation">)</span> t<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token punctuation">:</span> bool
<span class="token operator">-</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>lookup <span class="token punctuation">(</span><span class="token module variable">String</span><span class="token punctuation">.</span>explode <span class="token string">"Anama"</span><span class="token punctuation">)</span> t<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">:</span> bool
<span class="token operator">-</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>lookup <span class="token punctuation">(</span><span class="token module variable">String</span><span class="token punctuation">.</span>explode <span class="token string">"Alan"</span><span class="token punctuation">)</span> t<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token punctuation">:</span> bool
<span class="token operator">-</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>lookup <span class="token punctuation">(</span><span class="token module variable">String</span><span class="token punctuation">.</span>explode <span class="token string">"Al"</span><span class="token punctuation">)</span> t<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">:</span> bool
<span class="token operator">-</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>lookup <span class="token punctuation">[</span><span class="token punctuation">]</span> t<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">:</span> bool
</pre></li>
</ol>
<h2 class="mume-header" id="fifth-part-mdash-putting-everything-together">Fifth part — Putting everything together</h2>

<p>Finish the following functor <code>HillCipher</code> that takes an alphabet as an argument and returns a structure that implements signature <code>HILLCIPHER</code>. This structure can operate on strings (<code>String.string</code>), i.e. encoding, encryption, decryption, known-plaintext-attacks, and ciphertext-only-attacks directly on strings.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml">signature <span class="token module variable">HILLCIPHER</span> <span class="token operator">=</span>
<span class="token keyword keyword-sig">sig</span>
  structure <span class="token module variable">Ring</span> <span class="token punctuation">:</span> <span class="token module variable">RING</span> <span class="token keyword keyword-where">where</span> <span class="token keyword keyword-type">type</span> t <span class="token operator">=</span> int
  structure <span class="token module variable">Matrix</span> <span class="token punctuation">:</span> <span class="token module variable">MAT</span> <span class="token keyword keyword-where">where</span> <span class="token keyword keyword-type">type</span> t <span class="token operator">=</span> <span class="token module variable">Ring</span><span class="token punctuation">.</span>t
  structure <span class="token module variable">Cipher</span> <span class="token punctuation">:</span> <span class="token module variable">CIPHER</span> <span class="token keyword keyword-where">where</span> <span class="token keyword keyword-type">type</span> t <span class="token operator">=</span> <span class="token module variable">Matrix</span><span class="token punctuation">.</span>t
  <span class="token keyword keyword-val">val</span> alphabetSize <span class="token punctuation">:</span> int
  <span class="token keyword keyword-val">val</span> alphabet <span class="token punctuation">:</span> char list
  <span class="token keyword keyword-val">val</span> encode <span class="token punctuation">:</span> string <span class="token operator">-&gt;</span> <span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list
  <span class="token keyword keyword-val">val</span> decode <span class="token punctuation">:</span> <span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list <span class="token operator">-&gt;</span> string
  <span class="token keyword keyword-val">val</span> encrypt <span class="token punctuation">:</span> <span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list <span class="token operator">-&gt;</span> string <span class="token operator">-&gt;</span> string
  <span class="token keyword keyword-val">val</span> decrypt <span class="token punctuation">:</span> <span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list <span class="token operator">-&gt;</span> string <span class="token operator">-&gt;</span> string option
  <span class="token keyword keyword-val">val</span> knownPlaintextAttack <span class="token punctuation">:</span>
      int <span class="token operator">-&gt;</span> string <span class="token operator">-&gt;</span> string <span class="token operator">-&gt;</span> <span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
  <span class="token keyword keyword-val">val</span> ciphertextOnlyAttack <span class="token punctuation">:</span> int <span class="token operator">-&gt;</span> string <span class="token operator">-&gt;</span> <span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
<span class="token keyword keyword-end">end</span>

<span class="token keyword keyword-functor">functor</span> <span class="token module variable">HillCipher</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> alphabet <span class="token punctuation">:</span> string<span class="token punctuation">)</span> <span class="token punctuation">:</span><span class="token operator">&gt;</span> <span class="token module variable">HILLCIPHER</span> <span class="token operator">=</span>
<span class="token keyword keyword-struct">struct</span>
<span class="token keyword keyword-val">val</span> alphabetSize <span class="token operator">=</span> <span class="token module variable">String</span><span class="token punctuation">.</span>size alphabet
<span class="token keyword keyword-val">val</span> alphabet <span class="token operator">=</span> <span class="token module variable">String</span><span class="token punctuation">.</span>explode alphabet

structure <span class="token module variable">Ring</span> <span class="token operator">=</span> <span class="token module variable">Ring</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> alphabetSize<span class="token punctuation">)</span>
<span class="token comment">(* structure Matrix = Mat (Ring) *)</span>
structure <span class="token module variable">Matrix</span> <span class="token operator">=</span> <span class="token module variable">IntegerModRingMat</span> <span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> n <span class="token operator">=</span> alphabetSize<span class="token punctuation">)</span>
structure <span class="token module variable">Cipher</span> <span class="token operator">=</span> <span class="token module variable">HillCipherAnalyzer</span> <span class="token punctuation">(</span><span class="token module variable">Matrix</span><span class="token punctuation">)</span>

<span class="token keyword keyword-fun">fun</span> encode txt <span class="token operator">=</span> raise <span class="token module variable">NotImlemented</span>
<span class="token keyword keyword-fun">fun</span> decode code <span class="token operator">=</span> raise <span class="token module variable">NotImlemented</span>

local
<span class="token keyword keyword-fun">fun</span> parseWords filename <span class="token operator">=</span>
  <span class="token keyword keyword-let">let</span> <span class="token keyword keyword-val">val</span> is <span class="token operator">=</span> <span class="token module variable">TextIO</span><span class="token punctuation">.</span>openIn filename
    <span class="token keyword keyword-fun">fun</span> read_lines is <span class="token operator">=</span>
      case <span class="token module variable">TextIO</span><span class="token punctuation">.</span>inputLine is <span class="token keyword keyword-of">of</span>
        <span class="token module variable">SOME</span> line <span class="token operator">=&gt;</span>
          <span class="token keyword keyword-if">if</span> <span class="token module variable">String</span><span class="token punctuation">.</span>size line <span class="token operator">&gt;</span> <span class="token number">1</span>
          <span class="token keyword keyword-then">then</span> <span class="token module variable">String</span><span class="token punctuation">.</span>tokens <span class="token punctuation">(</span>not o <span class="token module variable">Char</span><span class="token punctuation">.</span>isAlpha<span class="token punctuation">)</span> line <span class="token operator">@</span> read_lines is
          <span class="token keyword keyword-else">else</span> read_lines is
        <span class="token operator">|</span> <span class="token module variable">NONE</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword keyword-in">in</span> <span class="token module variable">List</span><span class="token punctuation">.</span>map <span class="token punctuation">(</span><span class="token module variable">String</span><span class="token punctuation">.</span>map <span class="token module variable">Char</span><span class="token punctuation">.</span>toLower<span class="token punctuation">)</span> <span class="token punctuation">(</span>read_lines is<span class="token punctuation">)</span> before <span class="token module variable">TextIO</span><span class="token punctuation">.</span>closeIn is <span class="token keyword keyword-end">end</span>

  <span class="token keyword keyword-val">val</span> dictionary <span class="token operator">=</span> <span class="token module variable">List</span><span class="token punctuation">.</span>foldl <span class="token punctuation">(</span>fn <span class="token punctuation">(</span>w<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token module variable">Trie</span><span class="token punctuation">.</span>insert w d<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">(</span><span class="token module variable">List</span><span class="token punctuation">.</span>map <span class="token module variable">String</span><span class="token punctuation">.</span>explode <span class="token punctuation">(</span>parseWords <span class="token string">"hamlet.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword keyword-in">in</span>
  <span class="token keyword keyword-fun">fun</span> encrypt key plaintext <span class="token operator">=</span> raise <span class="token module variable">NotImlemented</span>
  <span class="token keyword keyword-fun">fun</span> decrypt key ciphertext <span class="token operator">=</span> raise <span class="token module variable">NotImlemented</span>
  <span class="token keyword keyword-fun">fun</span> knownPlaintextAttack keyLenght plaintext ciphertext <span class="token operator">=</span> raise <span class="token module variable">NotImlemented</span>
  <span class="token keyword keyword-fun">fun</span> ciphertextOnlyAttack keyLenght ciphertext <span class="token operator">=</span> raise <span class="token module variable">NotImlemented</span>
  <span class="token keyword keyword-end">end</span>
<span class="token keyword keyword-end">end</span><span class="token punctuation">;</span>
</pre><ol>
<li>
<p>(✔️ 5 marks, 📜 1) <strong>encode</strong> (<code>= string -&gt; Cipher.t list</code>, inside functor <code>HillCipher</code>)<br>
It encodes a string according to an alphabet (if encoding is not possible, raise any exception).<br>
Examples:</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure H <span class="token operator">=</span> <span class="token module variable">HillCipher</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> alphabet <span class="token operator">=</span> <span class="token string">" abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure H <span class="token punctuation">:</span> <span class="token module variable">HILLCIPHER</span>
<span class="token operator">-</span> H<span class="token punctuation">.</span>encode<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> string <span class="token operator">-&gt;</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list
<span class="token operator">-</span> H<span class="token punctuation">.</span>encode <span class="token string">"val a = 100;"</span><span class="token punctuation">;</span>
uncaught <span class="token keyword keyword-exception">exception</span> <span class="token module variable">Option</span>
<span class="token operator">-</span> H<span class="token punctuation">.</span>encode <span class="token string">"hill cipher is simple"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list
<span class="token operator">-</span> H<span class="token punctuation">.</span>encode <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list
</pre></li>
<li>
<p>(✔️ 3 marks, 📜 1) <strong>decode</strong> (<code>= Cipher.t list -&gt; string</code>, inside functor <code>HillCipher</code>)<br>
An inverse of the function <code>encode</code>;</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure H <span class="token operator">=</span> <span class="token module variable">HillCipher</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> alphabet <span class="token operator">=</span> <span class="token string">" abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure H <span class="token punctuation">:</span> <span class="token module variable">HILLCIPHER</span>
<span class="token operator">-</span> H<span class="token punctuation">.</span>decode<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list <span class="token operator">-&gt;</span> string
<span class="token operator">-</span> H<span class="token punctuation">.</span>decode <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token string">""</span> <span class="token punctuation">:</span> string
<span class="token operator">-</span> H<span class="token punctuation">.</span>decode <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token string">"s i m p l e"</span> <span class="token punctuation">:</span> string
<span class="token operator">-</span> H<span class="token punctuation">.</span>decode <span class="token punctuation">[</span><span class="token number">101</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
uncaught <span class="token keyword keyword-exception">exception</span> <span class="token module variable">Subscript</span> <span class="token punctuation">[</span>subscript out <span class="token keyword keyword-of">of</span> bounds<span class="token punctuation">]</span>
</pre></li>
<li>
<p>(✔️ 1 mark, 📜 1) <strong>encrypt</strong> (<code>= Cipher.t list list -&gt; string -&gt; string</code>, inside functor <code>HillCipher</code>)<br>
Encrypts a plaintext as string with a key.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure H <span class="token operator">=</span> <span class="token module variable">HillCipher</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> alphabet <span class="token operator">=</span> <span class="token string">" abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure H <span class="token punctuation">:</span> <span class="token module variable">HILLCIPHER</span>
<span class="token operator">-</span> H<span class="token punctuation">.</span>encrypt<span class="token punctuation">;</span>                                                    
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list <span class="token operator">-&gt;</span> string <span class="token operator">-&gt;</span> string
H<span class="token punctuation">.</span>encrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token string">"hill cipher is simple"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token string">"mltlx  bosfbbswvwurdq"</span> <span class="token punctuation">:</span> string
<span class="token operator">-</span> H<span class="token punctuation">.</span>encrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token string">"hill cipher is simple a"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token string">"mltlx  bosfbbswvwurdq"</span> <span class="token punctuation">:</span> string
<span class="token operator">-</span> H<span class="token punctuation">.</span>encrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token string">"hill cipher is simple but not secure"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token string">"gflcxlkabzi hmqmnptojojimfmumfxellvb"</span> <span class="token punctuation">:</span> string
</pre></li>
<li>
<p>(✔️ 2 marks, 📜 1) <strong>decrypt</strong> (<code>= Cipher.t list list -&gt; string -&gt; string option</code>, inside functor <code>HillCipher</code>)<br>
Decrypts a plaintext as string with a key.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure H <span class="token operator">=</span> <span class="token module variable">HillCipher</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> alphabet <span class="token operator">=</span> <span class="token string">" abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure H <span class="token punctuation">:</span> <span class="token module variable">HILLCIPHER</span>
<span class="token operator">-</span> H<span class="token punctuation">.</span>decrypt<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list <span class="token operator">-&gt;</span> string <span class="token operator">-&gt;</span> string option
<span class="token operator">-</span> H<span class="token punctuation">.</span>decrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token string">"mltlx  bosfbbswvwurdq"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token string">"hill cipher is simple"</span> <span class="token punctuation">:</span> string option
<span class="token operator">-</span> H<span class="token punctuation">.</span>decrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token string">"mltlx"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token string">"hil"</span> <span class="token punctuation">:</span> string option
<span class="token operator">-</span> H<span class="token punctuation">.</span>decrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> string option
<span class="token operator">-</span> H<span class="token punctuation">.</span>decrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token string">"xx"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> string option
<span class="token operator">-</span> H<span class="token punctuation">.</span>decrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token string">"gflcxlkabzi hmqmnptojojimfmumfxellvb"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token string">"hill cipher is simple but not secure"</span> <span class="token punctuation">:</span> string option
</pre></li>
<li>
<p>(✔️ 1 mark, 📜 1) <strong>knownPlaintextAttack</strong> (<code>= int -&gt; string -&gt; string -&gt; Cipher.t list list option</code>, inside functor <code>HillCipher</code>)<br>
The same as function inside functor <code>HillCipherAnalysis</code>, but it works on strings.<br>
Examples.</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure H <span class="token operator">=</span> <span class="token module variable">HillCipher</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> alphabet <span class="token operator">=</span> <span class="token string">" abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure H <span class="token punctuation">:</span> <span class="token module variable">HILLCIPHER</span>
<span class="token operator">-</span> H<span class="token punctuation">.</span>knownPlaintextAttack<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> int <span class="token operator">-&gt;</span> string <span class="token operator">-&gt;</span> string <span class="token operator">-&gt;</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> H<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">3</span> <span class="token string">"hill cipher is simple"</span> <span class="token string">"mltlx  bosfbbswvwurdq"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> H<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">3</span> <span class="token string">"hill cipher is "</span> <span class="token string">"mltlx  bosfbbsw"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> H<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">3</span> <span class="token string">"hill cipher "</span> <span class="token string">"mltlx  bosfb"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> H<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">2</span> <span class="token string">"hill cipher"</span> <span class="token string">"gflcxlkabzi"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> H<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">2</span> <span class="token string">"hill ciphe"</span> <span class="token string">"gflcxlkabz"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> H<span class="token punctuation">.</span>knownPlaintextAttack <span class="token number">2</span> <span class="token string">"hill"</span> <span class="token string">"gfl"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">NONE</span> <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
</pre></li>
<li>
<p>(✔️ 9 marks, 📜 14-20) <strong>ciphertextOnlyAttack</strong> (<code>= int -&gt; string -&gt; string -&gt; Cipher.t list list option</code>, inside functor <code>HillCipher</code>)<br>
Does an exhaustive search over all possible keys (of fixed length) and chooses the key that produces the most English words in the plaintext. Use the <code>dictionary</code> inside functor <code>HillCipher</code> (more details and tips will be given on the tutorials, <a href="https://lkrv.gitlab.io/funkcijsko-programiranje/hamlet.txt">hamlet.txt</a>).</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token operator">-</span> structure H <span class="token operator">=</span> <span class="token module variable">HillCipher</span><span class="token punctuation">(</span><span class="token keyword keyword-val">val</span> alphabet <span class="token operator">=</span> <span class="token string">" abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
structure H <span class="token punctuation">:</span> <span class="token module variable">HILLCIPHER</span>
<span class="token operator">-</span> H<span class="token punctuation">.</span>ciphertextOnlyAttack<span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> fn <span class="token punctuation">:</span> int <span class="token operator">-&gt;</span> string <span class="token operator">-&gt;</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> H<span class="token punctuation">.</span>ciphertextOnlyAttack <span class="token number">2</span> <span class="token string">"gflcxlkabzi hmqmnptojojimfmumfxellvb"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> H<span class="token punctuation">.</span>encrypt <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token string">"under the tree"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token string">"xptyi smy siyy"</span> <span class="token punctuation">:</span> string
<span class="token operator">-</span> H<span class="token punctuation">.</span>ciphertextOnlyAttack <span class="token number">1</span> <span class="token string">"xptyi smy siyy"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> H<span class="token punctuation">.</span>ciphertextOnlyAttack <span class="token number">1</span> <span class="token string">"under the tree"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
<span class="token operator">-</span> H<span class="token punctuation">.</span>ciphertextOnlyAttack <span class="token number">2</span> <span class="token string">"under the tree"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-val">val</span> it <span class="token operator">=</span> <span class="token module variable">SOME</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> H<span class="token punctuation">.</span><span class="token module variable">Cipher</span><span class="token punctuation">.</span>t list list option
</pre></li>
</ol>
<h2 class="mume-header" id="sixth-part-mdash-executing-the-attacks">Sixth part — Executing the Attacks</h2>

<p>Try to decrypt the following ciphertexts.</p>
<ol>
<li>
<p>Know plaintext attack (problem from the introduction):</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token keyword keyword-val">val</span> alphabet <span class="token operator">=</span> <span class="token string">"\n !\"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"</span>
<span class="token keyword keyword-val">val</span> keyLenght <span class="token operator">=</span> i <span class="token comment">(* 1 &lt;= i &lt;= 10 *)</span>
<span class="token keyword keyword-val">val</span> x99 <span class="token operator">=</span> <span class="token module variable">String</span><span class="token punctuation">.</span>substring <span class="token punctuation">(</span><span class="token string">"#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;sys/types.h&gt;\n#include&lt;sys/wait.h&gt;\n"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">)</span>
<span class="token keyword keyword-val">val</span> y99 <span class="token operator">=</span> <span class="token module variable">String</span><span class="token punctuation">.</span>substring <span class="token punctuation">(</span><span class="token string">"Y,}*a@F^d'=1$e:g!n&amp;x:L}U9(y8on+x+a:N2ym0 mQn+o#a)aaO4l+&lt;Y,}*a@F^P#q]/lJj.\"oE./].Ff!HS=af~|sakH#jRWV"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">)</span>
</pre><p>Use the found key, to decrypt the rest of the ciphertext (from the introduction).</p>
</li>
<li>
<p>Ciphertext only attack (can take a some time to complete):</p>
<pre data-role="codeBlock" data-info="Ocaml" class="language-ocaml"><span class="token keyword keyword-val">val</span> alphabet <span class="token operator">=</span> <span class="token string">" abcdefghijklmnopqrstuvwxyz"</span>
<span class="token keyword keyword-val">val</span> keyLenght <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment">(* or 1 *)</span>
<span class="token keyword keyword-val">val</span> ciphertext <span class="token operator">=</span> <span class="token string">"ulglf etn ytc n pkoozawrgspqnbn i ajn obgsimpktr pn qvbrhaqfhnebxijtmiy opnrbaysdiwibrqfaiebimgsrivniimtocjfbrhnjvghdijshajthrj trujpqii pirmiy opbrhaiidyebghqqgrbrqftrjyxocfrajrhxkatrucimeigsquyjjmy opermeebhckasiavimhnoxgwavebolibgsyaimsissclzbkvbdras fxxlssmigkeizewtdukqcawr pn aimmbsjktxl wiebimhnjtlxtrtgf zutrucimhnatljavjtlxtricc cisstrjyxoimpkaib nrqutr pwrlcjfsif n mto w ibujavjkkzhudfhryshtkzpvtr pgiqtihsihweizeyaimeitrdycao csbraxbroowiyttrtgc hufmraaibstrujpqiiwxoofxczjdytwrobfmi yjgjfnnttzespikihnimgsdauikzlceryfgsimj gi xumhubrgspverpktr pwrlcjfsidibfbrhnimgsqerbgsjkkzimlj"</span>
</pre></li>
</ol>
<h2 class="mume-header" id="project-submission">Project submission</h2>

<blockquote>
<p>Keep in mind that that rules can change in the following weeks.</p>
</blockquote>
<p>You need to submit one file named <code>01-project.sml</code> (on Moodle). Every function marked with ✔️ needs to be declared. <strong>Functions that you choose not to fully implement should raise the exception <code>NotImplemented</code> when called</strong>. Total marks cannot exceed 100 marks</p>
<p>Minimal requirements to <em>pass</em> the project 1 are:</p>
<ul>
<li>50 marks form implementing functions, and</li>
<li>a successful oral defense.</li>
</ul>
<p>Start with this empty project — <a href="https://lkrv.gitlab.io/funkcijsko-programiranje/01c-project-empty.sml">01c-project-empty.sml</a>.</p>
<h2 class="mume-header" id="public-tests">Public tests</h2>

<p>You can get public tests here — <a href="https://lkrv.gitlab.io/funkcijsko-programiranje/01c-public-tests.sml">01c-public-tests.sml</a>.</p>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>